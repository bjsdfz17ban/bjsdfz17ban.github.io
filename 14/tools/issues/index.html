<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="content-language" content="zh-CN">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-app-status-bar-style" content="white">
    <link rel="apple-touch-icon" href="//kevinwu521.gitee.io/res/banhui192.png">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>留言板</title>
    <link rel="stylesheet" type="text/css" href="/all.css">
    <link rel="stylesheet" type="text/css" href="/text.css">
    <link rel="stylesheet" type="text/css" href="/form.css">
    <link rel="stylesheet" type="text/css" href="/div.css">
    <script src="/common.js"></script>
    <script src="/14/init.js"></script>
    <style>
        div.res{
            width: calc(100vw - 80px);
            margin: 10px 10px;
            padding: 20px;
            border-radius: 10px;
            background-color: #ddd;
            display: block;
        }
    </style>
</head>
<body>
    <a href="/14"></a>
    <ers_bar></ers_bar>
    <textarea id="cont" style="width: calc(100vw - 40px); margin: 0 10px;" placeholder="留言内容(不超过256字)"></textarea>
    <button onclick="onCl();" style="width: calc(100vw - 20px); margin: 0 10px;padding: 10px"><div sty;e="background-color: #ddd; padding: 3px;">点击提交</div></button>
    <h1>&ensp;留言列表</h1>
    <div id="res">加载中……</div>
    <script>
        function onCl(){
            var ajax = new XMLHttpRequest();
            ajax.onload = GET;
            console.log(getIP(17666));
            ajax.open('POST',getIP(17666) + '/biaobaiinsert');
            var msg = encodeURIComponent(getObj('cont').value);
            if (msg.length > 256){
                alert('留言过长！');
                return;
            }
            ajax.send('msg=' + msg);
            getObj("cont").value = "";
        }
        getObj('cont').addEventListener('keyup',function(e){
            if (e.keyCode == 13)
                onCl();
        })
        function GET(){
            var ajax = new XMLHttpRequest();
            ajax.onload = function(){
                console.log('load');
                getObj('res').innerHTML = ajax.responseText;
            }
            ajax.open('GET',getIP(17666) + '/biaobai');
            ajax.send();
        }
        window.addEventListener('load',GET);
    </script>
</body>
</html>